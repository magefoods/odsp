<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ontario Government Payment Dates</title>
  <style>
    /* ... your existing styles ... */
    .payment-date {
      padding: 0.5rem;
      margin-bottom: 0.5rem;
      border-left: 4px solid #667eea;
      background: #f8f9fa;
      border-radius: 4px;
    }
    .highlight-next {
      background: #d1ecf1;
      border-left-color: #17a2b8;
    }
    .tbc-odsp {
      font-style: italic;
      border-left-color: rgb(255, 152, 0);
    }
    /* rest unchanged */
  </style>
</head>
<body>
  <!-- header, nav, announcements unchanged -->

  <main>
    <nav>
      <a href="changelog.html">View Changelog</a>
    </nav>

    <div id="monthly-announcement" class="announcement" style="display: none;"></div>
    <div id="payment-sections"></div>
  </main>

  <footer>
    <p>This information is compiled from community sources and official government websites.<br>Always verify payment dates with official sources.</p>
    <p style="margin-top: 0.5rem; font-style: italic;">Last updated: July 30th, 12:05 PM</p>
  </footer>

  <script>
    const data = {
      ODSP: [
        "July 31, 2025",
        "August 29, 2025",
        "September 29, 2025",
        "October 31, 2025",
        "November 28, 2025",
        // TBC December message won't be shown as a date but added separately
      ],
      Trillium: ["July 10, 2025", "August 8, 2025", "September 10, 2025", "October 10, 2025", "November 10, 2025"],
      GST: ["October 3, 2025"],
      Disability: ["July 17, 2025", "August 21, 2025", "September 18, 2025", "October 16, 2025"],
      CCB: ["July 18, 2025", "August 20, 2025", "September 19, 2025", "October 20, 2025"],
      CWB: ["July 11, 2025", "October 10, 2025"],
      CPP: ["July 29, 2025", "August 27, 2025", "September 25, 2025", "October 29, 2025"]
    };

    const specialMessages = {
      8: `<li><strong>ODSP:</strong> September 29th (Monday) releases September 27th (Saturday) for many banks</li>`,
      9: `<li><strong>CCB:</strong> October 20th (Monday) releases October 18th (Saturday) for many banks</li>`,
      10: `<li><strong>Trillium:</strong> November 10th (Monday) releases November 8th (Saturday) for many banks</li>`
    };

    function showSpecialAnnouncement() {
      const month = new Date().getMonth(); // 0-indexed
      const box = document.getElementById("monthly-announcement");
      if (specialMessages[month]) {
        box.style.display = "block";
        box.innerHTML = `<strong>Important Weekend Release Information</strong><p>Most banks will release Monday payments on Saturday:</p><ul style='margin-top: 0.5rem; margin-left: 1.5rem; text-align: left;'>${specialMessages[month]}</ul>`;
      }
    }

    function renderSections() {
      const container = document.getElementById("payment-sections");
      const today = new Date();

      Object.entries(data).forEach(([name, dates]) => {
        const section = document.createElement("section");
        section.className = "payment-card";
        const heading = document.createElement("h2");
        heading.textContent = name;
        section.appendChild(heading);

        // Convert dates and filter upcoming
        const upcoming = dates
          .map(d => ({ raw: d, date: new Date(d) }))
          .filter(d => d.date >= today);

        if (upcoming.length > 0) {
          const [first, ...rest] = upcoming;

          const nextEl = document.createElement("div");
          nextEl.className = "payment-date highlight-next";
          nextEl.textContent = first.raw;
          section.appendChild(nextEl);

          if (rest.length > 0 || name === "ODSP") {
            const moreDiv = document.createElement("div");
            moreDiv.style.display = "none";

            rest.forEach(item => {
              const el = document.createElement("div");
              el.className = "payment-date";
              el.textContent = item.raw;
              moreDiv.appendChild(el);
            });

            // Add December TBC for ODSP at the end
            if (name === "ODSP") {
              const tbcDiv = document.createElement("div");
              tbcDiv.className = "payment-date tbc-odsp";
              tbcDiv.textContent = "December 2025 — TBC for the ODSP payment";
              moreDiv.appendChild(tbcDiv);
            }

            const btn = document.createElement("button");
            btn.className = "toggle-more";
            btn.textContent = "Show All";
            btn.addEventListener("click", () => {
              const expanded = moreDiv.style.display === "block";
              moreDiv.style.display = expanded ? "none" : "block";
              btn.textContent = expanded ? "Show All" : "Hide";
            });

            section.appendChild(moreDiv);
            section.appendChild(btn);
          }
        } else {
          // If no upcoming payments, just show all dates (optional)
          dates.forEach(d => {
            const el = document.createElement("div");
            el.className = "payment-date";
            el.textContent = d;
            section.appendChild(el);
          });
          // Add TBC December for ODSP if this is ODSP
          if (name === "ODSP") {
            const tbcDiv = document.createElement("div");
            tbcDiv.className = "payment-date tbc-odsp";
            tbcDiv.textContent = "December 2025 — TBC for the ODSP payment";
            section.appendChild(tbcDiv);
          }
        }

        container.appendChild(section);
      });
    }

    showSpecialAnnouncement();
    renderSections();
  </script>
</body>
</html>
